<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip="">
  
  <py:def function="page_title">${c.group.display_name}</py:def>
  <py:def function="page_heading">${c.group.display_name}</py:def>

  <py:match path="primarysidebar">
  
    <li class="widget-container widget_text">
      <ul class="property-list">
        <py:if test="c.group_admins">
        <li>
        <h3>Administrators</h3> 
          <ul py:for="admin in c.group_admins">
            <li>${h.linked_user(admin)}</li>
          </ul>
        </li>
        </py:if>
      </ul>
    </li>
  </py:match>

  <py:match path="content">
    <h3 py:if="c.group['state'] != 'active'">State: ${c.group['state']}</h3>
    <div class="notes" py:if="str(c.group_description_formatted).strip()">
      ${c.group_description_formatted}
    </div>
    <div class="group-dataset-list">
      <div class="group-search-box">
        <form method="GET" class="group-search" id="group-search">
          <input type="search" name="q" class="search" placeholder="Search this group..." />
          <input type="submit" value="Search" class="pretty-button primary button"/>
        </form>
      </div>
      <h3>Datasets</h3>
      <p py:if="not c.q" i18n:msg="item_count">There are ${c.page.item_count} datasets in this group.</p>
      <p py:if="c.q">You searched for "${c.q}". Matched ${len(c.page.items)} out of ${c.page.item_count} datasets.</p>
      ${c.page.pager()}

      <py:for each="package in c.page.items">
        <div class="search-result ${'fullyopen' if (package.isopen and package.get('resources')) else None}">
          <a class="view-more-link" href="${h.url_for(controller='package', action='read', id=package.get('name'))}">View</a>
          <a class="main-link" href="${h.url_for(controller='package', action='read', id=package.get('name'))}">${package.get('title') or package.get('name')}</a>
          &nbsp;&nbsp;
          <py:if test="package.resources">
            <py:for each="resource in package.resources">
              <py:if test="resource.get('format')">
                <a href="${resource.get('url')}"
                  title="${resource.get('description')}"><span class="format-box">${resource.get('format')}</span></a>
              </py:if>
            </py:for>
          </py:if>
          <p class="result-description">${h.markdown_extract(package.notes)}</p>

          <span class="result-url">
            <py:if test="package.isopen">
              <a href="http://opendefinition.org/okd/" title="This dataset satisfies the Open Definition.">
                <img src="http://assets.okfn.org/images/ok_buttons/od_80x15_blue.png" alt="[Open Data]" />
              </a>
            </py:if>
            <py:if test="not package.isopen">
              ${h.icon('lock')} Not Openly Licensed
            </py:if>
          </span>
        </div>
      </py:for>
      ${c.page.pager()}
    </div>
  </py:match>

  <xi:include href="layout.html" />
</html>


