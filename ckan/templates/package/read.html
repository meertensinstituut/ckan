<!DOCTYPE html>
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude">
    <xi:include href="../page.html" />
    <head>
      <title>${c.pkg_dict.get('title', c.pkg_dict['name'])} - Datasets</title>
    </head>
    <body>
      <nav class="toolbar">
        <ol class="breadcrumb">
          <li>${h.nav_link(_('Datasets'), controller='package', action='search', highlight_actions = 'new index')}</li>
          <li class="active"><a href="">${c.pkg_dict.get('title', c.pkg_dict.get('name'))}</a></li>
        </ol>
        <ul class="actions">
          <li><a class="btn" href=""><i class="ckan-icon ckan-icon-rewind"></i> History</a></li>
          <li><a class="btn" href="" py:if="h.check_access('package_update',{'id':c.pkg.id})"><i class="ckan-icon ckan-icon-tools"></i> Edit</a></li>
          <li><a class="btn" href=""><i class="ckan-icon ckan-icon-flag"></i> Report Issue</a></li>
        </ul>
      </nav>

      <div class="primary test" data-cake="test">
        <div py:if="c.pkg_revision_id" class="widget info">
          <p py:if="c.pkg_revision_not_latest" class="content">This is an old revision of this dataset, as edited at ${h.render_datetime(c.pkg_revision_timestamp, with_hours=True)}. It may differ significantly from the <a href="${h.url(controller='package', action='read', id=c.pkg.name)}">current revision</a>.</p>
          <p py:if="not c.pkg_revision_not_latest" class="content">This is the current revision of this dataset, as edited at ${h.render_datetime(c.pkg_revision_timestamp, with_hours=True)}.</p>
        </div>

        <article class="module prose">
          <section class="content">
            <h1>${c.pkg_dict.get('title', c.pkg_dict.get('name'))}</h1>
            <div class="notes" py:if="str(c.pkg_notes_formatted).strip()">
              ${c.pkg_notes_formatted}
            </div>
            <span class="insert-comment-thread"></span>
          </section>

          <section id="dataset-resources" class="resources content">
            <h3>Resources</h3>
            <ul class="resource-list" py:if="len(c.pkg_dict.get('resources', []))">
              <li class="resource-item" py:for="res in c.pkg_dict.get('resources', [])" py:with="url=h.url_for(controller='package', action='resource_read', id=c.pkg_dict['name'], resource_id=res['id'])">
                <a class="heading" href="${url}">
                  ${h.resource_display_name(res)}
                  <span py:if="res.get('format')" class="format-box" property="dc:format">${res.get('format')}</span>
                </a>
                <p class="description">${h.markdown_extract(res.description, extract_length=80)}</p>
                <a class="btn btn-primary" href="${url}">Explore Data</a>
              </li>
            </ul>
            <py:if test="not len(c.pkg_dict.get('resources', []))">
              (none)
            </py:if>
          </section>
          <section class="tags content">
            ${h.snippet('snippets/tag_list.html', tags=c.pkg_dict.tags)}
          </section>
          <section class="content additional-info">
            <h3>Additional Info</h3>
            <table class="table table-striped table-bordered table-condensed">
              <thead>
                <tr>
                  <th>Field</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
                <tr py:if="c.pkg.url">
                  <th class="dataset-label">Source</th>
                  <td class="dataset-details" property="foaf:homepage">${c.pkg_url_link}</td>
                </tr>

                <tr py:if="c.pkg_author_link">
                  <th class="dataset-label">Author</th>
                  <td class="dataset-details" property="dc:creator">${c.pkg_author_link}</td>
                </tr>

                <tr py:if="c.pkg_maintainer_link">
                  <th class="dataset-label">Maintainer</th>
                  <td class="dataset-details" property="dc:contributor">${c.pkg_maintainer_link}</td>
                </tr>

                <tr py:if="c.pkg.version">
                  <th class="dataset-label">Version</th>
                  <td class="dataset-details">${c.pkg.version}</td>
                </tr>

                <tr py:if="c.eu_country">
                  <th class="dataset-label">Country</th>
                  <td class="dataset-details">${h.code_to_country(c.eu_country)}</td>
                </tr>

                <tr py:if="h.check_access('package_update',{'id':c.pkg.id})">
                  <td class="dataset-label">State</td>
                  <td class="dataset-details">${c.pkg.state}</td>
                </tr>

                <tr py:if="c.harvest_catalogue_name">
                  <th class="dataset-label">Harvest Source</th>
                  <td class="dataset-details" i18n:msg="harvest_catalogue_name">
                    <a href="${c.harvest_dataset_url}">Dataset page</a> on 
                    <a href="${c.harvest_catalogue_url}">${c.harvest_catalogue_name}</a>
                  </td>
                </tr>

                <tr py:for="i, (key, value) in enumerate(c.pkg_extras)" rel="dc:relation" resource="_:extra${i}">
                  <th class="dataset-label" property="rdfs:label">${_(key)}</th>
                  <td class="dataset-details" property="rdf:value">${value}</td>
                </tr>
              </tbody>
            </table>
          </section>
        </article>
      </div>

      <aside class="secondary">
        <section class="module subscribe">
          <h2 class="heading"><i class="ckan-icon ckan-icon-add"></i> Subscribe</h2>
          <ul class="nav nav-simple">
            <li><a href="#"><i class="ckan-icon ckan-icon-email"></i> Email</a></li>
            <li><a href="#"><i class="ckan-icon ckan-icon-feed"></i> RSS</a></li>
          </ul>
        </section>

        <section class="module social">
          <h2 class="heading"><i class="ckan-icon ckan-icon-share"></i> Social</h2>
          <ul class="nav nav-simple">
            <li><a href="#"><i class="ckan-icon ckan-icon-gplus"></i> Google+</a></li>
            <li><a href="#"><i class="ckan-icon ckan-icon-twitter"></i> Twitter</a></li>
            <li><a href="#"><i class="ckan-icon ckan-icon-fb"></i> Facebook</a></li>
          </ul>
        </section>

        <section class="module info related" py:if="True">
          <h2 class="heading"><i class="ckan-icon ckan-icon-photo"></i> Related <a class="action" href="#">Add Related</a></h2>
          <p class="content">Some interesting summary of this featured item. This
          may or may not have a slideshow.</p>
        </section>

        <section class="module info related empty" py:if="True">
          <h2 class="heading"><i class="ckan-icon ckan-icon-photo"></i> Related</h2>
          <div class="content">
            <p>No apps, ideas, news stories or images have been
            related to this dataset yet, why not add one now?</p>
            <p class="action"><a class="btn" href="#">Add Item</a></p>
          </div>
        </section>

        <section class="module info license" py:if="c.pkg.license_id">
          <h2 class="heading"><i class="ckan-icon ckan-icon-lock"></i> License</h2>
          <p class="content">
            <a py:if="c.pkg_dict.get('license_url')" href="${c.pkg_dict.get('license_url')}" rel="dc:rights">${c.pkg_dict.get('license_title')}</a>
            <span py:if="c.pkg.license" property="dc:rights">${c.pkg_dict.get('license_title')}</span>
            <a py:if="c.pkg_dict.get('isopen')" href="http://opendefinition.org/okd/" title="This dataset satisfies the Open Definition.">
              <img class="open-data" src="http://assets.okfn.org/images/ok_buttons/od_80x15_blue.png" alt="[Open Data]" />
            </a>
            <span py:if="not c.pkg_dict.get('isopen')" class="closed">${h.icon('lock')}</span>
          </p>
        </section>

        <section class="module disqus-trackback">
          <h2 class="heading"><i class="ckan-icon ckan-icon-clipboard"></i> Trackback URL</h2>
          <div class="field"><input type="text" value="http://trackback.com" /></div>
        </section>
      </aside>
    </body>
</html>
