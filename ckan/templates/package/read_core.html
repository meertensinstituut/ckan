<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  py:strip=""
  >
  <xi:include href="../_util.html" />

  <!-- Dataset tabs -->
  <!-- <div id="dataset-tab-bar"> -->
  <!--   <ul id="dataset-tabs"> -->
  <!--     <li><a href="#section-overview" class="active">Overview</a></li> -->
  <!--     <li><a href="#section-more-information">More Information</a></li> -->
  <!--   </ul> -->
  <!-- </div> -->

  <div id="dataset" class="dataset">

    <!-- Overview Section -->
    <div id="dataset-overview">

      <!-- Description -->
      <div class="notes" py:if="str(c.pkg_notes_formatted).strip()">
        ${c.pkg_notes_formatted}
      </div>

      <!-- Image -->
      <!-- <div id="dataset-image"></div> -->
      
      <!-- Resources -->
      <div id="dataset-resources" class="resources subsection">
        <h3>Resources</h3>
        <py:for each="res in c.pkg_dict.get('resources', [])">
          <div class="dataset-resource">
            <a class="resource-view-url"
               href="${url(controller='package', action='resource_read', id=c.pkg_dict['id'], resource_id=res['id'])}">
              <py:if test="res.get('name')">${res.get('name')}</py:if>
              <py:if test="not res.get('name')">(no name)</py:if>
            </a>
            <span class="resource-format" property="dc:format">${res.get('format', '(unknown format)')}</span>
            <div class="resource-description">${h.markdown_extract(res.get('description'))}</div>
            <div class="resource-url" rel="dcat:distribution" resource="_:res${res.id}"
              typeof="dcat:Distribution">
                <a href="${res.get('url', '')}" rel="dcat:accessURL" target="_blank">
                  ${res.get('url', '')}
                </a>
            </div>
            <ul class="resource-information">
              <li py:if="res.get('last_modified')">
                Last updated: ${h.time_ago_in_words_from_str(res.get('last_modified'), granularity='day')} ago
              </li>
            </ul>
          </div>
        </py:for>
        <py:if test="not len(c.pkg_dict.get('resources', []))">
          (none)
        </py:if>
      </div>

    </div>

    <!-- More Information Section -->
    <div id="dataset-more-information">
      <h3>Additional Information</h3>
      <dl>
        <py:if test="c.pkg.url">
          <dt>Source</dt>
          <dd property="foaf:homepage">${c.pkg_url_link}</dd>
        </py:if>

        <py:if test="c.pkg_author_link">
          <dt>Author</dt>
          <dd property="dc:creator">${c.pkg_author_link}</dd>
        </py:if>
        
        <py:if test="c.pkg_maintainer_link">
          <dt>Maintainer</dt>
          <dd property="dc:contributor">${c.pkg_maintainer_link}</dd>
        </py:if>

        <py:if test="c.pkg.version">
          <dt>Version</dt>
          <dd>${c.pkg.version}</dd>
        </py:if>

        <py:if test="c.eu_country">
          <dt>Country</dt>
          <dd>${h.code_to_country(c.eu_country)}</dd>
        </py:if>

        <py:if test="h.check_access('package_update',{'id':c.pkg.id})">
          <dt>State</dt>
          <dd>${c.pkg.state}</dd>
        </py:if>

        <py:if test="c.harvest_catalogue_name">
          <dt>Harvest Source</dt>
          <dd><a href="${c.harvest_dataset_url}">Dataset page</a> on 
            <a href="${c.harvest_catalogue_url}">${c.harvest_catalogue_name}</a></dd>
        </py:if>

        <!-- Dataset Extras -->
        <py:for each="i, (key, value) in enumerate(c.pkg_extras)">
          <dt rel="dc:relation" resource="_:extra${i}" property="rdfs:label">${_(key)}</dt>      
          <dd rel="dc:relation" resource="_:extra${i}" property="rdfs:value">${value}</dd>
        </py:for>
      </dl>
    </div>

  </div> <!-- /dataset -->

</html>
