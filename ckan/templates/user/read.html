{% extends "page.html" %}

{% set user = c.user_dict %}

{% block title %}{{ user.display_name }} - {{ super() }}{% endblock %}

{% block breadcrumb %}
  <ol class="breadcrumb">
    <li class="home hide-text"><a class="ckan-icon ckan-icon-bookmark" href="{{ h.url('home') }}">Home</a></li>
    <li>{{ h.nav_link(_('User'), controller='user', action='index') }}</li>
    {% with title = _('Your Profile') if c.is_myself  else user.display_name %}
      <li class="current">{{  h.nav_link(title, controller='user', action='read', id=user.name) }}</li>
    {% endwith %}
  </ol>
{% endblock %}

{% block actions %}
  <ul class="actions">
    <li>{{ h.nav_link(_('Edit'), controller='user', action='edit', id=user.name, class_='btn', icon='star') }}</li>
  </ul>
{% endblock %}

{% block primary_content %}
  <article class="module profile">
    <div class="content profile-info">
      <header class="media">
        <span class="image">{{ h.linked_gravatar(user.email_hash, 150) }}</span>
        <div class="description">
          <h1 class="heading">{{ user.fullname or _('No full name provided') }}</h1>
          {% if user.about_formatted %}
            {{ user.about_formatted }}
          {% else %}
            <p class="empty">
              {% if c.is_myself %}
                {% trans %}You have not provided a biography.{% endtrans %}
              {% else %}
                {% trans %}This user has no biography.{% endtrans %}
              {% endif %}
            </p>
          {% endif %}
        </div>
      </header>
      <ul class="listing unstyled">
        <li>
          <b class="key">{{ _('Username') }}:</b>
          <span class="value">{{ user.name }}</span>
        </li>
        {% if c.is_myself %}
          <li>
            <b class="key">{{ _('Email') }}:</b>
            <span class="value">{{ user.email }}</span>
          </li>
        {% endif %}
        <li>
          <b class="key">{{ _('Member Since') }}:</b>
          <span class="value">{{ h.render_datetime(user.created) }}</span>
        </li>
        {% if c.is_myself %}
          <li>
            <b class="key">{{ _('API Key') }}:</b>
            <span class="value">{{ user.apikey }}</span>
          </li>
        {% endif %}
        <li>
          <b class="key">{{ _('Datasets') }}::</b>
          <span class="value">{{ user.number_administered_packages }}</span>
          <b class="key" class="inline">{{ _('Edits') }}:</b>
          <span class="value">{{ user.number_of_edits }}</span>
        </li>
      </ul>
      <ul class="nav nav-tabs">
        <li class="active"><a href="#datasets">{{ _('Datasets') }}</a></li>
        <li><a href="#activity">{{ _('Activity Stream') }}</a></li>
      </ul>
    </div>
    <div id="packages" class="content clearfix">
      {% snippet 'snippets/package_list.html', packages=user.datasets %}
    </div>
    <div id="activity" class="content">
      {{ c.user_activity_stream | safe }}
    </div>
  </article>
{% endblock %}

{% block secondary_content %}
  {% snippet 'user/snippets/user_search.html' %}
{% endblock %}
